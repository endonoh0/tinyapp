<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/_head') %>
</head>

<body>
    <header class="container">
        <%- include('./partials/_header') %>
    </header>

    <main id="wrapper" class="card text-center">
        <div class="card-body">
            <% if (user) { %>
                <!-- Display long and short url -->
                <h3 id="text-2xl">TinyURL for: <%= longURL.longURL %></h3>
                <p class="card-text pt-4">Short URL: <a href="/u/<%= shortURL %>"><%= shortURL %></a></p>
            <% } %>
                <div id="url" class="centercon">
                    <form id="card" class="form-inline mt-4"
                        method="POST" action="/urls/<%= shortURL %>/update?_method=PUT">

                        <h2 class="mr-3">Edit</h2>
                        <div class="form-group mb-2">
                            <input
                                type="text"
                                name="longURL"
                                placeholder="<%= longURL.longURL %>"
                                required
                            >
                            <button type="submit" class="btn btn-primary ml-3">Submit</button>
                        </div>
                    </form>
                </div>

                <table class="table mt-5">
                    <thead>
                        <tr>
                            <td scope="col">Visitor ID</td>
                            <td scope="col">Date Visit</td>
                            <td scope="col">Total Visits: 0</td>
                            <td scope="col">Unique Visits: 0</td>
                        </tr>
                    </thead>
                    <tbody>
                        <% for (const url in urlInfo) { %>
                            <% for (const stat of urlInfo[url]) { %>
                            <tr>
                                <td><%= stat.visitorID %></td>
                                <td><%= stat.date %></td>
                            </tr>
                            <% } %>
                        <% } %>
                    </tbody>
                </table>
            <% if (!user) { %>
                <div id='error' class='invisible'><%= errorMessage %></div>
            <% } %>
        </div>
    </main>

    <footer><%- include('./partials/_footer') %></footer>
    <script>
        $("td:empty").remove();
    </script>
</body>
</html>
